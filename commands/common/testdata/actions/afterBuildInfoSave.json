{
  "action": {
    "application": "artifactory",
    "name": "AFTER_BUILD_INFO_SAVE"
  },
  "description": "After Build Info events are triggered after build info has been saved in the Artifactory storage.",
  "samplePayload": "{\"build\":{\"name\":\"buildName\",\"number\":\"buildNumber\",\"started\":\"1980-01-01T00:00:00.000+0000\",\"buildAgent\":\"GENERIC/1.00.0\",\"agent\":\"jfrog-cli-go/1.00.0\",\"durationMillis\":1000,\"principal\":\"bob\",\"artifactoryPrincipal\":\"artifactoryPrincipal\",\"url\":\"url\",\"parentName\":\"parentName\",\"parentNumber\":\"parentNumber\",\"buildRepo\":\"buildRepo\",\"modules\":[{\"id\":\"module1\",\"artifacts\":[{\"name\":\"name\",\"type\":\"type\",\"sha1\":\"sha1\",\"sha256\":\"sha256\",\"md5\":\"md5\",\"remotePath\":\"remotePath\",\"properties\":\"properties\"}],\"dependencies\":[{\"id\":\"id\",\"scopes\":\"scopes\",\"requestedBy\":\"requestedBy\"}]}],\"releaseStatus\":\"releaseStatus\",\"promotionStatuses\":[{\"status\":\"status\",\"comment\":\"comment\",\"repository\":\"repository\",\"timestamp\":\"timestamp\",\"user\":\"user\",\"ciUser\":\"ciUser\"}]}}",
  "sampleCode": "\nexport default async (context: PlatformContext, data: AfterBuildInfoSaveRequest): Promise<AfterBuildInfoSaveResponse> => {\n    try {\n        // The HTTP client facilitates calls to the JFrog Platform REST APIs\n        //To call an external endpoint, use 'await context.clients.axios.get(\"https://foo.com\")'\n        const res = await context.clients.platformHttp.get(\"/artifactory/api/v1/system/readiness\");\n\n        // You should reach this part if the HTTP request status is successful (HTTP Status 399 or lower)\n        if (res.status === 200) {\n            console.log(\"Artifactory ping success\");\n        } else {\n            console.warn(`Request was successful and returned status code : ${res.status}`);\n        }\n    } catch (error) {\n        // The platformHttp client throws PlatformHttpClientError if the HTTP request status is 400 or higher\n        console.error(`Request failed with status code ${error.status || \"<none>\"} caused by : ${error.message}`);\n    }\n\n    return {\n        message: \"proceed\",\n    };\n};\n",
  "typesDefinitions": "\ninterface AfterBuildInfoSaveRequest {\n    /** Various immutable build run details */\n    build: DetailedBuildRun | undefined;\n}\n\ninterface DetailedBuildRun {\n    name: string;\n    number: string;\n    started: string;\n    buildAgent: string;\n    agent: string;\n    durationMillis: number;\n    principal: string;\n    artifactoryPrincipal: string;\n    url: string;\n    parentName: string;\n    parentNumber: string;\n    buildRepo: string;\n    modules: Module[];\n    releaseStatus: string;\n    promotionStatuses: PromotionStatus[];\n}\n\ninterface Module {\n    id: string;\n    artifacts: Artifact[];\n    dependencies: Dependency[];\n}\n\ninterface Artifact {\n    name: string;\n    type: string;\n    sha1: string;\n    sha256: string;\n    md5: string;\n    remotePath: string;\n    properties: string;\n}\n\ninterface Dependency {\n    id: string;\n    scopes: string;\n    requestedBy: string;\n}\n\ninterface PromotionStatus {\n    status: string;\n    comment: string;\n    repository: string;\n    timestamp: string;\n    user: string;\n    ciUser: string;\n}\n\ninterface AfterBuildInfoSaveResponse {\n    /** Message to print to the log, in case of an error it will be printed as a warning */\n    message: string;\n}\n",
  "supportProjects": true,
  "wikiUrl": "https://jfrog.com/help/r/jfrog-platform-administration-documentation/create-an-after-build-info-save-worker",
  "async": true,
  "executionRequestType": "AfterBuildInfoSaveRequest"
}